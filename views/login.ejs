<!DOCTYPE html>
<html>
<head>
  <title>MySearch Hub - Login</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="login-page">
  <div class="login-container">
    <h1 class="glitch" data-text="MySearch Hub">MySearch Hub</h1>

    <% if (error) { %>
      <div class="error-message"><%= error %></div>
    <% } %>
    <% if (success) { %>
      <div class="success-message"><%= success %></div>
    <% } %>

    <form action="/login" method="POST" class="login-form">
      <div class="input-group">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" placeholder="Enter your username" required>
      </div>
      <div class="input-group">
        <label for="password">Password:</label>
        <input type="password" id="password" name="password" placeholder="Enter your password" required>
      </div>
      <button type="submit">Login</button>
    </form>

    <p>Don't have an account? <a href="/register">Register here</a></p>

    <div class="divider">OR</div>

    <a href="/auth/google" class="login-button">
      <span class="google-icon">G</span> Sign in with Google
    </a>
  </div>

  <script>
    // Check if we're on localhost but the app is actually deployed to production
    function checkEnvironment() {
      const hostname = window.location.hostname;
      const referrer = document.referrer;
      
      // If we're on localhost and came from the production URL 
      // or we have a special flag in localStorage
      if (hostname === 'localhost' && 
          (referrer.includes('railway.app') || localStorage.getItem('useProduction'))) {
        
        // Store a flag so we know to redirect in the future
        localStorage.setItem('useProduction', 'true');
        
        // Show a message to the user
        if (confirm('It appears you\'re accessing the local version but your app is deployed to production. Would you like to go to the production version?')) {
          window.location.href = 'https://mysearch-hub-production.up.railway.app' + window.location.pathname;
        }
      }
    }
    
    // Run the check when the page loads
    checkEnvironment();
  </script>
</body>
</html>